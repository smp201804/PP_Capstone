---
title: "PP_Capstone_Proposal"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

### Examining the causes of Power Plant Outages with respect to Frequency, nmber of outages, and Severity, duration of outages.

This study will examine the causes of US power plant outages based on the following data from the North American Electrical Reliability Corporation (NERC) Generating Availability Data System (GADS).
* CC_GT_2011_2017.csv - Combined Cycle Power Plants
* GT_Jet_Engine_2013_2016.csv - Simple Cycle Power Plants
* Fossil_steam_2013_2017.csv - Fossil Fuel Fired Boiler Steam Power Plants

In each data file, the cause is determined by the "cause code", column/variable 5.

It could be useful to examine outage duration in categories or bands.
* 1 to 10 Days - Low Severity
* 11 to 30 Days - Medium Severity
* Greater than 30 Days - High Severity

Cause Codes should be examined in each category for number of outages per cause, as well as total outage time per cause.

With respect to graphing and plotting, a plot depicting which causes are most responsible (top 20?) in each category and mapping the relationship is the goal.

With respect to outage type, "Type" / column 4, the following should be ignored as they are planned or maintenance outages and derates.
* MO - Maintenance Outage
* PE - Planned Extension
* PD - Planned Derate
* PO - Planned Outage
* RS - Reserve Shutdown

The first wrangling step is to clean the column names.
library(tidyverse)
# clean column names for combined and simple cycle power plant data sets
# fossil fuel steam already cleaned

#   create data frame for combined cycle
c_cycle_edit <- read.csv("CC_GT_2011_2017.csv")

#   replace . or series of . with _
names(c_cycle_edit) <- gsub(x = names(c_cycle_edit),
                            pattern = "(\\.)+",
                            replacement = "_")

#   replace trailing _ with ""
names(c_cycle_edit) <- gsub(x = names(c_cycle_edit),
                            pattern = "(_)+$",
                            replacement = "")

#   create working combined cycle file
write.csv(c_cycle_edit, file = "c_cycle_work.csv")

#   create data frame for simple cycle
s_cycle_edit <- read.csv("GT_Jet_Engine_2013_2016.csv")

#   replace . or series of . with _
names(s_cycle_edit) <- gsub(x = names(s_cycle_edit),
                            pattern = "(\\.)+",
                            replacement = "_")

#   replace trailing _ with ""
names(s_cycle_edit) <- gsub(x = names(s_cycle_edit),
                            pattern = "(_)+$",
                            replacement = "")

#   create working combined cycle file
write.csv(s_cycle_edit, file = "s_cycle_work.csv")


#create a combined field for start date and start time, start_dt

ff_steam_work <- ff_steam_work %>%
  mutate(start_dt = paste(StartDate, StartTime, sep = " ", collapse = NULL)) %>%
  mutate(start_dt = mdy_hms(start_dt))

c_cycle_work <- c_cycle_work %>%
  mutate(start_dt = paste(StartDate, StartTime, sep = " ")) %>%
  mutate(start_dt = mdy_hm(start_dt))

s_cycle_work <- s_cycle_work %>%
  mutate(start_dt = paste(StartDate, StartTime, sep = " ")) %>%
  mutate(start_dt = mdy_hm(start_dt))

#create a combined field for end date and end time, end_dt

ff_steam_work <- ff_steam_work %>%
  mutate(end_dt = paste(End_Date, End_Time, sep = " ", collapse = NULL)) %>%
  mutate(end_dt = mdy_hms(end_dt))

c_cycle_work <- c_cycle_work %>%
  mutate(end_dt = paste(End_Date, End_Time, sep = " ")) %>%
  mutate(end_dt = mdy_hm(end_dt))

s_cycle_work <- s_cycle_work %>%
  mutate(end_dt = paste(End_Date, End_Time, sep = " ")) %>%
  mutate(end_dt = mdy_hm(end_dt))

#create a field for outage duration, out_duration, measured in hours

ff_steam_work <- ff_steam_work %>%
  mutate(out_duration = ((end_dt - start_dt) / 60))

c_cycle_work <- c_cycle_work %>%
  mutate(out_duration = ((end_dt - start_dt) / 60))

s_cycle_work <- s_cycle_work %>%
  mutate(out_duration = ((end_dt - start_dt) / 60))

#create a new data frame with specific fields in new order

ff_steam_worka <- ff_steam_work %>%
  select(Util_Unit, start_dt, Type, Cause_Code, end_dt,
         Time_To_Repair, TBF_Period_Hrs, IA_PH, 
         TBF_Service_Hrs, IA_SH, X_Derate)

c_cycle_worka <- c_cycle_work %>%
  select(Util_Unit, start_dt, Type, Cause_Code, end_dt,
         Time_To_Repair, TBF_Period_Hrs, IA_PH, 
         TBF_Service_Hrs, IA_SH, X_Derate)

s_cycle_worka <- s_cycle_work %>%
  select(Util_Unit, start_dt, Type, Cause_Code, end_dt,
         Time_To_Repair, TBF_Period_Hrs, IA_PH, 
         TBF_Service_Hrs, IA_SH, X_Derate)



#convert Cause_Code iteger field to 4 character string/character field
ff_steam_exp <- ff_steam_worka

ff_steam_exp <- ff_steam_exp %>%
  mutate(Cause_Code = as.character(Cause_Code)) %>%
  mutate(Cause_Code = if_else(nchar(Cause_Code) == 2, paste0("00", Cause_Code),
                              if_else(nchar(Cause_Code) == 3, paste0("0", Cause_Code),
                                      if_else(nchar(Cause_Code) == 1, paste0("000", Cause_Code), Cause_Code))))

write.csv(ff_steam_exp, file = "ff_steam_expt.csv")


c_cycle_exp <- c_cycle_worka

c_cycle_exp <- c_cycle_exp %>%
  mutate(Cause_Code = as.character(Cause_Code)) %>%
  mutate(Cause_Code = if_else(nchar(Cause_Code) == 2, paste0("00", Cause_Code),
                              if_else(nchar(Cause_Code) == 3, paste0("0", Cause_Code),
                                      if_else(nchar(Cause_Code) == 1, paste0("000", Cause_Code), Cause_Code))))

write.csv(c_cycle_exp, file = "c_cycle_expt.csv")


s_cycle_expx <- s_cycle_worka

s_cycle_exp <- s_cycle_expx %>%
  mutate(Cause_Code = as.character(Cause_Code)) %>%
  mutate(Cause_Code = if_else(nchar(Cause_Code) == 2, paste0("00", Cause_Code),
                              if_else(nchar(Cause_Code) == 3, paste0("0", Cause_Code),
                                      if_else(nchar(Cause_Code) == 1, paste0("000", Cause_Code), Cause_Code))))

write.csv(s_cycle_exp, file = "s_cycle_expt.csv")

